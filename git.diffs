diff --git a/TAGS b/TAGS
index b1c6564..cec055f 100644
--- a/TAGS
+++ b/TAGS
@@ -2,553 +2,533 @@
 ./Setup.hs,15
 main main1,2
 
-./test/Main.hs,2687
-module Main Main6,7
-main main30,31
-tests tests33,34
-instance Arbitrary Arbitrary Dur-Duration85,86
-  arbitrary arbitrary86,87
-  shrink shrink87,88
-instance Arbitrary Arbitrary Note-Note89,90
-  arbitrary arbitrary90,91
-  shrink shrink91,92
-instance Arbitrary Arbitrary Rest-Rest93,94
-  arbitrary arbitrary94,95
-  shrink shrink95,96
-instance Arbitrary Arbitrary Chord-Chord97,98
-  arbitrary arbitrary98,99
-  shrink shrink99,100
-instance Arbitrary Arbitrary Oct-Octave101,102
-  arbitrary arbitrary102,103
-  shrink shrink103,104
-instance Arbitrary Arbitrary Acc-Accent105,106
-  arbitrary arbitrary106,107
-  shrink shrink107,108
-instance Arbitrary Arbitrary Dyn-Dynamic109,110
-  arbitrary arbitrary110,111
-  shrink shrink111,112
-instance Arbitrary Arbitrary Pit-Pitch113,114
-  arbitrary arbitrary114,115
-  shrink shrink115,116
-instance Arbitrary Arbitrary Mod-Mode117,118
-  arbitrary arbitrary118,119
-  shrink shrink119,120
-instance Arbitrary Arbitrary KeySig-KeySignature121,122
-  arbitrary arbitrary122,123
-  shrink shrink123,124
-instance Arbitrary Arbitrary Temp-Tempo125,126
-  arbitrary arbitrary126,127
-instance Arbitrary Arbitrary TSig-TimeSignature132,133
-  arbitrary arbitrary133,134
-  shrink shrink134,135
-propParseLilytoLilyOct propParseLilytoLilyOct136,137
-propToLilyparseLilyOct propToLilyparseLilyOct139,140
-propParseLilytoLilyDur propParseLilytoLilyDur142,143
-propToLilyparseLilyDur propToLilyparseLilyDur145,146
-propDurSum2Durs propDurSum2Durs148,149
-propParseLilytoLilyPit propParseLilytoLilyPit151,152
-propToLilyparseLilyPit propToLilyparseLilyPit154,155
-propParseLilytoLilyAcc propParseLilytoLilyAcc157,158
-propToLilyparseLilyAcc propToLilyparseLilyAcc160,161
-propParseLilytoLilyDyn propParseLilytoLilyDyn163,164
-propToLilyparseLilyDyn propToLilyparseLilyDyn166,167
-propParseLilytoLilyNote propParseLilytoLilyNote169,170
-propToLilyparseLilyNote propToLilyparseLilyNote172,173
-propParseLilytoLilyRest propParseLilytoLilyRest178,179
-propToLilyparseLilyRest propToLilyparseLilyRest181,182
-propParseLilytoLilyChord propParseLilytoLilyChord186,187
-propToLilyparseLilyChord propToLilyparseLilyChord189,190
-propParseLilytoLilyMode propParseLilytoLilyMode197,198
-propToLilyparseLilyMode propToLilyparseLilyMode200,201
-propParseLilytoLilyKeySig propParseLilytoLilyKeySig203,204
-propToLilyparseLilyKeySig propToLilyparseLilyKeySig206,207
-propParseLilytoLilyTemp propParseLilytoLilyTemp211,212
-propToLilyparseLilyTemp propToLilyparseLilyTemp214,215
-propParseLilytoLilyTSig propParseLilytoLilyTSig219,220
-propToLilyparseLilyTSig propToLilyparseLilyTSig222,223
+./test/Main.hs,1311
+module Main Main7,8
+main main32,33
+tests tests35,36
+instance Arbitrary Arbitrary Duration75,76
+  arbitrary arbitrary76,77
+  shrink shrink77,78
+instance Arbitrary Arbitrary Note79,80
+  arbitrary arbitrary80,81
+  shrink shrink81,82
+instance Arbitrary Arbitrary Rest83,84
+  arbitrary arbitrary84,85
+  shrink shrink85,86
+instance Arbitrary Arbitrary Chord87,88
+  arbitrary arbitrary88,89
+  shrink shrink89,90
+instance Arbitrary Arbitrary Octave91,92
+  arbitrary arbitrary92,93
+  shrink shrink93,94
+instance Arbitrary Arbitrary Accent95,96
+  arbitrary arbitrary96,97
+  shrink shrink97,98
+instance Arbitrary Arbitrary Dynamic99,100
+  arbitrary arbitrary100,101
+  shrink shrink101,102
+instance Arbitrary Arbitrary Pitch103,104
+  arbitrary arbitrary104,105
+  shrink shrink105,106
+instance Arbitrary Arbitrary Mode107,108
+  arbitrary arbitrary108,109
+  shrink shrink109,110
+instance Arbitrary Arbitrary KeySignature111,112
+  arbitrary arbitrary112,113
+  shrink shrink113,114
+instance Arbitrary Arbitrary Tempo115,116
+  arbitrary arbitrary116,117
+instance Arbitrary Arbitrary TimeSignature122,123
+  arbitrary arbitrary123,124
+  shrink shrink124,125
+propParseLilytoLilyVal propParseLilytoLilyVal126,127
+propDurSum2Durs propDurSum2Durs129,130
 
 ./exec/Main.hs,37
 module Main Main1,2
 main main3,4
 
 ./src/Utils.hs,384
-module Utils Utils0,1
-parseInt parseInt16,17
-parseNatural parseNatural19,20
-parseBool parseBool22,23
-mkParser mkParser25,26
-mkToLily mkToLily28,29
-mkParseLily mkParseLily31,32
-whitespace whitespace36,37
-lexeme lexeme39,40
-symbol symbol42,43
-identifier identifier45,46
-parseQuotedString parseQuotedString51,52
-parseQuotedIdentifier parseQuotedIdentifier54,55
+module Utils Utils1,2
+parseInt parseInt18,19
+parseNatural parseNatural21,22
+parseBool parseBool24,25
+mkParser mkParser27,28
+mkToLily mkToLily30,31
+mkParseLily mkParseLily33,34
+whitespace whitespace38,39
+lexeme lexeme41,42
+symbol symbol44,45
+identifier identifier47,48
+parseQuotedString parseQuotedString53,54
+parseQuotedIdentifier parseQuotedIdentifier56,57
 
 ./src/Voice.hs,875
-data Voice Voice14,15
-  SingleVoice SingleVoice15,16
-  SingleVoice { _singleVoiceInstrument _singleVoiceInstrument15,16
-  SingleVoice { _singleVoiceInstrument :: Instrument, _singleVoiceVoiceEvents _singleVoiceVoiceEvents15,16
-  | VoiceGroup VoiceGroup16,17
-  | VoiceGroup { _voiceGroupVoices _voiceGroupVoices16,17
-  | PolyVoice PolyVoice17,18
-  | PolyVoice { _polyVoiceInstrument _polyVoiceInstrument17,18
-  | PolyVoice { _polyVoiceInstrument :: Instrument, _polyVoiceVoiceEvents _polyVoiceVoiceEvents17,18
-instance ToLily ToLily Voice20,21
-  toLily toLily21,22
-toSingleVoice toSingleVoice25,26
-toVoiceGroup toVoiceGroup33,34
-eventsToPolyVoice eventsToPolyVoice39,40
-toPolyVoice toPolyVoice47,48
-parsePolyVoiceEvents parsePolyVoiceEvents56,57
-parseVoice parseVoice59,60
-instance FromLily FromLily Voice68,69
-  parseLily parseLily69,70
+data Voice Voice13,14
+  SingleVoice SingleVoice14,15
+  SingleVoice { _singleVoiceInstrument _singleVoiceInstrument14,15
+  SingleVoice { _singleVoiceInstrument :: Instrument, _singleVoiceVoiceEvents _singleVoiceVoiceEvents14,15
+  | VoiceGroup VoiceGroup15,16
+  | VoiceGroup { _voiceGroupVoices _voiceGroupVoices15,16
+  | PolyVoice PolyVoice16,17
+  | PolyVoice { _polyVoiceInstrument _polyVoiceInstrument16,17
+  | PolyVoice { _polyVoiceInstrument :: Instrument, _polyVoiceVoiceEvents _polyVoiceVoiceEvents16,17
+instance ToLily ToLily Voice19,20
+  toLily toLily20,21
+toSingleVoice toSingleVoice24,25
+toVoiceGroup toVoiceGroup32,33
+eventsToPolyVoice eventsToPolyVoice38,39
+toPolyVoice toPolyVoice46,47
+parsePolyVoiceEvents parsePolyVoiceEvents55,56
+parseVoice parseVoice58,59
+instance FromLily FromLily Voice67,68
+  parseLily parseLily68,69
 
 ./src/Dynamic.hs,2064
-data Dynamic Dynamic15,16
-data Dynamic = PPPPP PPPPP15,16
-data Dynamic = PPPPP | PPPP PPPP15,16
-data Dynamic = PPPPP | PPPP | PPP PPP15,16
-data Dynamic = PPPPP | PPPP | PPP | PP PP15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano Piano15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP MP15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF MF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte Forte15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF FF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF FFF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF FFFF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF FFFFF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP FP15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF SF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF SFF15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP SP15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP SPP15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ SFZ15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ | RFZ RFZ15,16
-data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ | RFZ | NoDynamicNoDynamic15,16
-lilySyms lilySyms19,20
-lilyVals lilyVals23,24
-instance ToLily ToLily Dynamic26,27
-  toLily toLily27,28
-parseDynamic parseDynamic29,30
-instance FromLily FromLily Dynamic32,33
-  parseLily parseLily33,34
+data Dynamic Dynamic10,11
+data Dynamic = PPPPP PPPPP10,11
+data Dynamic = PPPPP | PPPP PPPP10,11
+data Dynamic = PPPPP | PPPP | PPP PPP10,11
+data Dynamic = PPPPP | PPPP | PPP | PP PP10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano Piano10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP MP10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF MF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte Forte10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF FF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF FFF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF FFFF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF FFFFF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP FP10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF SF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF SFF10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP SP10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP SPP10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ SFZ10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ | RFZ RFZ10,11
+data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ | RFZ | NoDynamicNoDynamic10,11
+lilySyms lilySyms14,15
+lilyVals lilyVals18,19
+instance ToLily ToLily Dynamic21,22
+  toLily toLily22,23
+parseDynamic parseDynamic24,25
+instance FromLily FromLily Dynamic27,28
+  parseLily parseLily28,29
 
 ./src/Tempo.hs,940
-data Tempo Tempo16,17
-data Tempo = TempoText TempoText16,17
-data Tempo = TempoText   { _ttText _ttText16,17
-           | Tempo Tempo17,18
-           | Tempo       { _tDur _tDur17,18
-           | Tempo       { _tDur :: Duration, _tPerMin _tPerMin17,18
-           | TempoLong TempoLong18,19
-           | TempoLong   { _tlText _tlText18,19
-           | TempoLong   { _tlText :: String, _tlDur _tlDur18,19
-           | TempoLong   { _tlText :: String, _tlDur :: Duration, _tlPerMin _tlPerMin18,19
-           | TempoRange TempoRange19,20
-           | TempoRange  { _trDur _trDur19,20
-           | TempoRange  { _trDur :: Duration, _trPerMinLo _trPerMinLo19,20
-           | TempoRange  { _trDur :: Duration, _trPerMinLo :: Natural, _trPerMinHi _trPerMinHi19,20
-instance ToLily ToLily Tempo22,23
-  toLily toLily23,24
-parseTempo parseTempo28,29
-instance FromLily FromLily Tempo34,35
-  parseLily parseLily35,36
+data Tempo Tempo13,14
+data Tempo = TempoText TempoText13,14
+data Tempo = TempoText   { _ttText _ttText13,14
+           | Tempo Tempo14,15
+           | Tempo       { _tDur _tDur14,15
+           | Tempo       { _tDur :: Duration, _tPerMin _tPerMin14,15
+           | TempoLong TempoLong15,16
+           | TempoLong   { _tlText _tlText15,16
+           | TempoLong   { _tlText :: String, _tlDur _tlDur15,16
+           | TempoLong   { _tlText :: String, _tlDur :: Duration, _tlPerMin _tlPerMin15,16
+           | TempoRange TempoRange16,17
+           | TempoRange  { _trDur _trDur16,17
+           | TempoRange  { _trDur :: Duration, _trPerMinLo _trPerMinLo16,17
+           | TempoRange  { _trDur :: Duration, _trPerMinLo :: Natural, _trPerMinHi _trPerMinHi16,17
+instance ToLily ToLily Tempo19,20
+  toLily toLily20,21
+parseTempo parseTempo25,26
+instance FromLily FromLily Tempo31,32
+  parseLily parseLily32,33
 
-./src/Mode.hs,294
-data Mode Mode15,16
-data Mode = Major Major15,16
-data Mode = Major | MinorMinor15,16
-lilySyms lilySyms19,20
-lilyVals lilyVals23,24
-instance ToLily ToLily Mode26,27
-  toLily toLily27,28
-parseMode parseMode29,30
-instance FromLily FromLily Mode32,33
-  parseLily parseLily33,34
+./src/Mode.hs,291
+data Mode Mode9,10
+data Mode = Major Major9,10
+data Mode = Major | MinorMinor9,10
+lilySyms lilySyms13,14
+lilyVals lilyVals17,18
+instance ToLily ToLily Mode20,21
+  toLily toLily21,22
+parseMode parseMode23,24
+instance FromLily FromLily Mode26,27
+  parseLily parseLily27,28
 
 ./src/Score.hs,348
-data Score Score11,12
-data Score = Score Score11,12
-data Score = Score { _scoreComment _scoreComment11,12
-data Score = Score { _scoreComment :: String, _scoreVoices _scoreVoices11,12
-instance ToLily ToLily Score14,15
-  toLily toLily15,16
-parseScore parseScore28,29
-instance FromLily FromLily Score32,33
-  parseLily parseLily33,34
+data Score Score12,13
+data Score = Score Score12,13
+data Score = Score { _scoreComment _scoreComment12,13
+data Score = Score { _scoreComment :: String, _scoreVoices _scoreVoices12,13
+instance ToLily ToLily Score15,16
+  toLily toLily16,17
+parseScore parseScore29,30
+instance FromLily FromLily Score33,34
+  parseLily parseLily34,35
 
 ./src/Octave.hs,1030
-data Octave Octave17,18
-data Octave = TwentyTwoVBOct TwentyTwoVBOct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct FifteenVBOct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct EightVBOct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct COct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct EightVAOct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct FifteenVAOct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct | TwentyTwoVAOct TwentyTwoVAOct17,18
-data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct | TwentyTwoVAOct | TwentyNineVAOctTwentyNineVAOct17,18
-lilyVals lilyVals21,22
-lilySyms lilySyms25,26
-instance ToLily ToLily Octave35,36
-  toLily toLily36,37
-parseOct parseOct38,39
-instance FromLily FromLily Octave41,42
-  parseLily parseLily42,43
-incrOct incrOct44,45
-decrOct decrOct47,48
+data Octave Octave14,15
+data Octave = TwentyTwoVBOct TwentyTwoVBOct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct FifteenVBOct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct EightVBOct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct COct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct EightVAOct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct FifteenVAOct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct | TwentyTwoVAOct TwentyTwoVAOct14,15
+data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct | TwentyTwoVAOct | TwentyNineVAOctTwentyNineVAOct14,15
+lilyVals lilyVals18,19
+lilySyms lilySyms22,23
+instance ToLily ToLily Octave32,33
+  toLily toLily33,34
+parseOct parseOct35,36
+instance FromLily FromLily Octave38,39
+  parseLily parseLily39,40
+incrOct incrOct41,42
+decrOct decrOct44,45
 
 ./src/Note.hs,865
-data Note Note17,18
-data Note = Note Note17,18
-data Note = Note { _notePitch _notePitch17,18
-data Note = Note { _notePitch :: Pitch, _noteoOctave _noteoOctave17,18
-data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration _noteDuration17,18
-data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration :: Duration, _notedDynamic _notedDynamic17,18
-data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration :: Duration, _notedDynamic :: Dynamic, _noteAccent _noteAccent17,18
-data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration :: Duration, _notedDynamic :: Dynamic, _noteAccent :: Accent, _noteSlur _noteSlur17,18
-instance ToLily ToLily Note20,21
-  toLily toLily21,22
-parseNote parseNote23,24
-instance FromLily FromLily Note26,27
-  parseLily parseLily27,28
+data Note Note14,15
+data Note = Note Note14,15
+data Note = Note { _notePitch _notePitch14,15
+data Note = Note { _notePitch :: Pitch, _noteoOctave _noteoOctave14,15
+data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration _noteDuration14,15
+data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration :: Duration, _notedDynamic _notedDynamic14,15
+data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration :: Duration, _notedDynamic :: Dynamic, _noteAccent _noteAccent14,15
+data Note = Note { _notePitch :: Pitch, _noteoOctave :: Octave, _noteDuration :: Duration, _notedDynamic :: Dynamic, _noteAccent :: Accent, _noteSlur _noteSlur14,15
+instance ToLily ToLily Note17,18
+  toLily toLily18,19
+parseNote parseNote20,21
+instance FromLily FromLily Note23,24
+  parseLily parseLily24,25
 
 ./src/Instrument.hs,8102
-data Instrument Instrument20,21
-       AcousticGrand AcousticGrand21,22
-       AcousticGrand |           Contrabass Contrabass21,22
-       AcousticGrand |           Contrabass |         LeadFfths LeadFfths21,22
-       BrightAcoustic BrightAcoustic22,23
-       BrightAcoustic |          TremoloStrings TremoloStrings22,23
-       BrightAcoustic |          TremoloStrings |     LeadBassPlusLead LeadBassPlusLead22,23
-       ElectricGrand ElectricGrand23,24
-       ElectricGrand |           PizzicatoStrings PizzicatoStrings23,24
-       ElectricGrand |           PizzicatoStrings |   PadNewAge PadNewAge23,24
-       HonkyTonk HonkyTonk24,25
-       HonkyTonk |               OrchestralHarp OrchestralHarp24,25
-       HonkyTonk |               OrchestralHarp |     PadWarm PadWarm24,25
-       ElectricPiano1 ElectricPiano125,26
-       ElectricPiano1 |          Timpani Timpani25,26
-       ElectricPiano1 |          Timpani |            PadPolysynth PadPolysynth25,26
-       ElectricPiano2 ElectricPiano226,27
-       ElectricPiano2 |          StringEnsemble1 StringEnsemble126,27
-       ElectricPiano2 |          StringEnsemble1 |    PadChoir PadChoir26,27
-       Harpsichord Harpsichord27,28
-       Harpsichord |             StringEnsemble2 StringEnsemble227,28
-       Harpsichord |             StringEnsemble2 |    PadBowed PadBowed27,28
-       Clav Clav28,29
-       Clav |                    Synthstrings1 Synthstrings128,29
-       Clav |                    Synthstrings1 |      PadMetallic PadMetallic28,29
-       Celesta Celesta29,30
-       Celesta |                 Synthstrings2 Synthstrings229,30
-       Celesta |                 Synthstrings2 |      Halo Halo29,30
-       Glockenspiel Glockenspiel30,31
-       Glockenspiel |            ChoirAahs ChoirAahs30,31
-       Glockenspiel |            ChoirAahs |          Sweep Sweep30,31
-       MusicBox MusicBox31,32
-       MusicBox |                VoiceOohs VoiceOohs31,32
-       MusicBox |                VoiceOohs |          Rain Rain31,32
-       Vibraphone Vibraphone32,33
-       Vibraphone |              SynthVoice SynthVoice32,33
-       Vibraphone |              SynthVoice |         Soundtrack Soundtrack32,33
-       Marimba Marimba33,34
-       Marimba |                 OrchestraHit OrchestraHit33,34
-       Marimba |                 OrchestraHit |       Crystal Crystal33,34
-       Xylophone Xylophone34,35
-       Xylophone |               Trumpet Trumpet34,35
-       Xylophone |               Trumpet |            Atmosphere Atmosphere34,35
-       TubularTells TubularTells35,36
-       TubularTells |            Trombone Trombone35,36
-       TubularTells |            Trombone |           Bbrightness Bbrightness35,36
-       Dulcimer Dulcimer36,37
-       Dulcimer |                Tuba Tuba36,37
-       Dulcimer |                Tuba |               Goblins Goblins36,37
-       DrawbarOrgan DrawbarOrgan37,38
-       DrawbarOrgan |            MutedTrumpet MutedTrumpet37,38
-       DrawbarOrgan |            MutedTrumpet |       Echoes Echoes37,38
-       PercussiveOrgan PercussiveOrgan38,39
-       PercussiveOrgan |         FrenchHorn FrenchHorn38,39
-       PercussiveOrgan |         FrenchHorn |         SciFi SciFi38,39
-       RockOrgan RockOrgan39,40
-       RockOrgan |               BrassSection BrassSection39,40
-       RockOrgan |               BrassSection |       Sitar Sitar39,40
-       ChurchOrgan ChurchOrgan40,41
-       ChurchOrgan |             Synthbrass1 Synthbrass140,41
-       ChurchOrgan |             Synthbrass1 |        Banjo Banjo40,41
-       ReedOrgan ReedOrgan41,42
-       ReedOrgan |               Synthbrass2 Synthbrass241,42
-       ReedOrgan |               Synthbrass2 |        Shamisen Shamisen41,42
-       Accordion Accordion42,43
-       Accordion |               SopranoSax SopranoSax42,43
-       Accordion |               SopranoSax |         Koto Koto42,43
-       Harmonica Harmonica43,44
-       Harmonica |               AltoSax AltoSax43,44
-       Harmonica |               AltoSax |            Kalimba Kalimba43,44
-       Concertina Concertina44,45
-       Concertina |              TenorSax TenorSax44,45
-       Concertina |              TenorSax |           Bagpipe Bagpipe44,45
-       AcousticGuitarNylon AcousticGuitarNylon45,46
-       AcousticGuitarNylon |     BaritoneSax BaritoneSax45,46
-       AcousticGuitarNylon |     BaritoneSax |        Fiddle Fiddle45,46
-       AcousticGuitarSteel AcousticGuitarSteel46,47
-       AcousticGuitarSteel |     Oboe Oboe46,47
-       AcousticGuitarSteel |     Oboe |               Shanai Shanai46,47
-       ElectricGuitarJazz ElectricGuitarJazz47,48
-       ElectricGuitarJazz |      EnglishHorn EnglishHorn47,48
-       ElectricGuitarJazz |      EnglishHorn |        TinkleBell TinkleBell47,48
-       ElectricGuitarClean ElectricGuitarClean48,49
-       ElectricGuitarClean |     Bassoon Bassoon48,49
-       ElectricGuitarClean |     Bassoon |            Agogo Agogo48,49
-       ElectricGuitarMuted ElectricGuitarMuted49,50
-       ElectricGuitarMuted |     Clarinet Clarinet49,50
-       ElectricGuitarMuted |     Clarinet |           SteelDrums SteelDrums49,50
-       OverdrivenGuitar OverdrivenGuitar50,51
-       OverdrivenGuitar |        Piccolo Piccolo50,51
-       OverdrivenGuitar |        Piccolo |            Woodblock Woodblock50,51
-       DistortedGuitar DistortedGuitar51,52
-       DistortedGuitar |         Flute Flute51,52
-       DistortedGuitar |         Flute |              TaikoDrum TaikoDrum51,52
-       GuitarHarmonics GuitarHarmonics52,53
-       GuitarHarmonics |         Recorder Recorder52,53
-       GuitarHarmonics |         Recorder |           MelodicTom MelodicTom52,53
-       AcousticBass AcousticBass53,54
-       AcousticBass |            PanFlute PanFlute53,54
-       AcousticBass |            PanFlute |           SynthDrum SynthDrum53,54
-       ElectricBassFinger ElectricBassFinger54,55
-       ElectricBassFinger |      BlownBottle BlownBottle54,55
-       ElectricBassFinger |      BlownBottle |        ReverseCymbal ReverseCymbal54,55
-       ElectricBassPick ElectricBassPick55,56
-       ElectricBassPick |        Shakuhachi Shakuhachi55,56
-       ElectricBassPick |        Shakuhachi |         GuitarFretNoise GuitarFretNoise55,56
-       FretlessBass FretlessBass56,57
-       FretlessBass |            Whistle Whistle56,57
-       FretlessBass |            Whistle |            BreathNoise BreathNoise56,57
-       SlapBass1 SlapBass157,58
-       SlapBass1 |               Ocarina Ocarina57,58
-       SlapBass1 |               Ocarina |            Seashore Seashore57,58
-       SlapBass2 SlapBass258,59
-       SlapBass2 |               LeadSquare LeadSquare58,59
-       SlapBass2 |               LeadSquare |         BirdTweet BirdTweet58,59
-       SynthBass1 SynthBass159,60
-       SynthBass1 |              LeadSawtooth LeadSawtooth59,60
-       SynthBass1 |              LeadSawtooth |       TelephoneRing TelephoneRing59,60
-       SynthBass2 SynthBass260,61
-       SynthBass2 |              LeadCalliope LeadCalliope60,61
-       SynthBass2 |              LeadCalliope |       Helicopter Helicopter60,61
-       Violin Violin61,62
-       Violin |                  LeadChiff LeadChiff61,62
-       Violin |                  LeadChiff |          Applause Applause61,62
-       Viola Viola62,63
-       Viola |                   LeadCharang LeadCharang62,63
-       Viola |                   LeadCharang |        Gunshot Gunshot62,63
-       Cello Cello63,64
-       Cello |                   LeadVoiceLeadVoice63,64
-lilySyms lilySyms67,68
-shortNames shortNames113,114
-lilyVals lilyVals160,161
-instance ToLily ToLily Instrument163,164
-  toLily toLily164,165
-parseInstrument parseInstrument166,167
-instance FromLily FromLily Instrument169,170
-  parseLily parseLily170,171
-midiName midiName172,173
-shortName shortName175,176
-shortName2LongName shortName2LongName178,179
+data Instrument Instrument17,18
+       AcousticGrand AcousticGrand18,19
+       AcousticGrand |           Contrabass Contrabass18,19
+       AcousticGrand |           Contrabass |         LeadFfths LeadFfths18,19
+       BrightAcoustic BrightAcoustic19,20
+       BrightAcoustic |          TremoloStrings TremoloStrings19,20
+       BrightAcoustic |          TremoloStrings |     LeadBassPlusLead LeadBassPlusLead19,20
+       ElectricGrand ElectricGrand20,21
+       ElectricGrand |           PizzicatoStrings PizzicatoStrings20,21
+       ElectricGrand |           PizzicatoStrings |   PadNewAge PadNewAge20,21
+       HonkyTonk HonkyTonk21,22
+       HonkyTonk |               OrchestralHarp OrchestralHarp21,22
+       HonkyTonk |               OrchestralHarp |     PadWarm PadWarm21,22
+       ElectricPiano1 ElectricPiano122,23
+       ElectricPiano1 |          Timpani Timpani22,23
+       ElectricPiano1 |          Timpani |            PadPolysynth PadPolysynth22,23
+       ElectricPiano2 ElectricPiano223,24
+       ElectricPiano2 |          StringEnsemble1 StringEnsemble123,24
+       ElectricPiano2 |          StringEnsemble1 |    PadChoir PadChoir23,24
+       Harpsichord Harpsichord24,25
+       Harpsichord |             StringEnsemble2 StringEnsemble224,25
+       Harpsichord |             StringEnsemble2 |    PadBowed PadBowed24,25
+       Clav Clav25,26
+       Clav |                    Synthstrings1 Synthstrings125,26
+       Clav |                    Synthstrings1 |      PadMetallic PadMetallic25,26
+       Celesta Celesta26,27
+       Celesta |                 Synthstrings2 Synthstrings226,27
+       Celesta |                 Synthstrings2 |      Halo Halo26,27
+       Glockenspiel Glockenspiel27,28
+       Glockenspiel |            ChoirAahs ChoirAahs27,28
+       Glockenspiel |            ChoirAahs |          Sweep Sweep27,28
+       MusicBox MusicBox28,29
+       MusicBox |                VoiceOohs VoiceOohs28,29
+       MusicBox |                VoiceOohs |          Rain Rain28,29
+       Vibraphone Vibraphone29,30
+       Vibraphone |              SynthVoice SynthVoice29,30
+       Vibraphone |              SynthVoice |         Soundtrack Soundtrack29,30
+       Marimba Marimba30,31
+       Marimba |                 OrchestraHit OrchestraHit30,31
+       Marimba |                 OrchestraHit |       Crystal Crystal30,31
+       Xylophone Xylophone31,32
+       Xylophone |               Trumpet Trumpet31,32
+       Xylophone |               Trumpet |            Atmosphere Atmosphere31,32
+       TubularTells TubularTells32,33
+       TubularTells |            Trombone Trombone32,33
+       TubularTells |            Trombone |           Bbrightness Bbrightness32,33
+       Dulcimer Dulcimer33,34
+       Dulcimer |                Tuba Tuba33,34
+       Dulcimer |                Tuba |               Goblins Goblins33,34
+       DrawbarOrgan DrawbarOrgan34,35
+       DrawbarOrgan |            MutedTrumpet MutedTrumpet34,35
+       DrawbarOrgan |            MutedTrumpet |       Echoes Echoes34,35
+       PercussiveOrgan PercussiveOrgan35,36
+       PercussiveOrgan |         FrenchHorn FrenchHorn35,36
+       PercussiveOrgan |         FrenchHorn |         SciFi SciFi35,36
+       RockOrgan RockOrgan36,37
+       RockOrgan |               BrassSection BrassSection36,37
+       RockOrgan |               BrassSection |       Sitar Sitar36,37
+       ChurchOrgan ChurchOrgan37,38
+       ChurchOrgan |             Synthbrass1 Synthbrass137,38
+       ChurchOrgan |             Synthbrass1 |        Banjo Banjo37,38
+       ReedOrgan ReedOrgan38,39
+       ReedOrgan |               Synthbrass2 Synthbrass238,39
+       ReedOrgan |               Synthbrass2 |        Shamisen Shamisen38,39
+       Accordion Accordion39,40
+       Accordion |               SopranoSax SopranoSax39,40
+       Accordion |               SopranoSax |         Koto Koto39,40
+       Harmonica Harmonica40,41
+       Harmonica |               AltoSax AltoSax40,41
+       Harmonica |               AltoSax |            Kalimba Kalimba40,41
+       Concertina Concertina41,42
+       Concertina |              TenorSax TenorSax41,42
+       Concertina |              TenorSax |           Bagpipe Bagpipe41,42
+       AcousticGuitarNylon AcousticGuitarNylon42,43
+       AcousticGuitarNylon |     BaritoneSax BaritoneSax42,43
+       AcousticGuitarNylon |     BaritoneSax |        Fiddle Fiddle42,43
+       AcousticGuitarSteel AcousticGuitarSteel43,44
+       AcousticGuitarSteel |     Oboe Oboe43,44
+       AcousticGuitarSteel |     Oboe |               Shanai Shanai43,44
+       ElectricGuitarJazz ElectricGuitarJazz44,45
+       ElectricGuitarJazz |      EnglishHorn EnglishHorn44,45
+       ElectricGuitarJazz |      EnglishHorn |        TinkleBell TinkleBell44,45
+       ElectricGuitarClean ElectricGuitarClean45,46
+       ElectricGuitarClean |     Bassoon Bassoon45,46
+       ElectricGuitarClean |     Bassoon |            Agogo Agogo45,46
+       ElectricGuitarMuted ElectricGuitarMuted46,47
+       ElectricGuitarMuted |     Clarinet Clarinet46,47
+       ElectricGuitarMuted |     Clarinet |           SteelDrums SteelDrums46,47
+       OverdrivenGuitar OverdrivenGuitar47,48
+       OverdrivenGuitar |        Piccolo Piccolo47,48
+       OverdrivenGuitar |        Piccolo |            Woodblock Woodblock47,48
+       DistortedGuitar DistortedGuitar48,49
+       DistortedGuitar |         Flute Flute48,49
+       DistortedGuitar |         Flute |              TaikoDrum TaikoDrum48,49
+       GuitarHarmonics GuitarHarmonics49,50
+       GuitarHarmonics |         Recorder Recorder49,50
+       GuitarHarmonics |         Recorder |           MelodicTom MelodicTom49,50
+       AcousticBass AcousticBass50,51
+       AcousticBass |            PanFlute PanFlute50,51
+       AcousticBass |            PanFlute |           SynthDrum SynthDrum50,51
+       ElectricBassFinger ElectricBassFinger51,52
+       ElectricBassFinger |      BlownBottle BlownBottle51,52
+       ElectricBassFinger |      BlownBottle |        ReverseCymbal ReverseCymbal51,52
+       ElectricBassPick ElectricBassPick52,53
+       ElectricBassPick |        Shakuhachi Shakuhachi52,53
+       ElectricBassPick |        Shakuhachi |         GuitarFretNoise GuitarFretNoise52,53
+       FretlessBass FretlessBass53,54
+       FretlessBass |            Whistle Whistle53,54
+       FretlessBass |            Whistle |            BreathNoise BreathNoise53,54
+       SlapBass1 SlapBass154,55
+       SlapBass1 |               Ocarina Ocarina54,55
+       SlapBass1 |               Ocarina |            Seashore Seashore54,55
+       SlapBass2 SlapBass255,56
+       SlapBass2 |               LeadSquare LeadSquare55,56
+       SlapBass2 |               LeadSquare |         BirdTweet BirdTweet55,56
+       SynthBass1 SynthBass156,57
+       SynthBass1 |              LeadSawtooth LeadSawtooth56,57
+       SynthBass1 |              LeadSawtooth |       TelephoneRing TelephoneRing56,57
+       SynthBass2 SynthBass257,58
+       SynthBass2 |              LeadCalliope LeadCalliope57,58
+       SynthBass2 |              LeadCalliope |       Helicopter Helicopter57,58
+       Violin Violin58,59
+       Violin |                  LeadChiff LeadChiff58,59
+       Violin |                  LeadChiff |          Applause Applause58,59
+       Viola Viola59,60
+       Viola |                   LeadCharang LeadCharang59,60
+       Viola |                   LeadCharang |        Gunshot Gunshot59,60
+       Cello Cello60,61
+       Cello |                   LeadVoiceLeadVoice60,61
+lilySyms lilySyms64,65
+shortNames shortNames110,111
+lilyVals lilyVals157,158
+instance ToLily ToLily Instrument160,161
+  toLily toLily161,162
+parseInstrument parseInstrument163,164
+instance FromLily FromLily Instrument166,167
+  parseLily parseLily167,168
+midiName midiName169,170
+shortName shortName172,173
+shortName2LongName shortName2LongName175,176
 
-./src/TimeSignature.hs,420
-data TimeSignature TimeSignature15,16
-data TimeSignature = TimeSignature TimeSignature15,16
-data TimeSignature = TimeSignature { _tsnum _tsnum15,16
-data TimeSignature = TimeSignature { _tsnum :: Int, _tsdenom _tsdenom15,16
-instance ToLily ToLily TimeSignature18,19
-  toLily toLily19,20
-parseTimeSignature parseTimeSignature21,22
-instance FromLily FromLily TimeSignature24,25
-  parseLily parseLily25,26
+./src/TimeSignature.hs,792
+data TimeSignature TimeSignature11,12
+data TimeSignature = TimeSignature TimeSignature11,12
+data TimeSignature = TimeSignature { _tsNum _tsNum11,12
+data TimeSignature = TimeSignature { _tsNum :: Int, _tsDenom _tsDenom11,12
+                   | TimeSignatureGrouping TimeSignatureGrouping12,13
+                   | TimeSignatureGrouping { _tsgGroups _tsgGroups12,13
+                   | TimeSignatureGrouping { _tsgGroups :: [Int], tsgNum tsgNum12,13
+                   | TimeSignatureGrouping { _tsgGroups :: [Int], tsgNum :: Int, tsgDenom tsgDenom12,13
+instance ToLily ToLily TimeSignature15,16
+  toLily toLily16,17
+parseTimeSignature parseTimeSignature19,20
+parseIntList parseIntList23,24
+instance FromLily FromLily TimeSignature26,27
+  parseLily parseLily27,28
 
 ./src/Pitch.hs,1540
-data Pitch Pitch15,16
-data Pitch = Bs Bs15,16
-data Pitch = Bs | C C15,16
-data Pitch = Bs | C   | Bss Bss15,16
-data Pitch = Bs | C   | Bss | Dff Dff15,16
-data Pitch = Bs | C   | Bss | Dff | CsCs15,16
-           | Df Df16,17
-           | Df | Css Css16,17
-           | Df | Css | D D16,17
-           | Df | Css | D   | Eff Eff16,17
-           | Df | Css | D   | Eff | DsDs16,17
-           | Ef Ef17,18
-           | Ef | Fff Fff17,18
-           | Ef | Fff | Dss Dss17,18
-           | Ef | Fff | Dss | E E17,18
-           | Ef | Fff | Dss | E   | FfFf17,18
-           | Es Es18,19
-           | Es | F F18,19
-           | Es | F   | Gff Gff18,19
-           | Es | F   | Gff | Ess Ess18,19
-           | Es | F   | Gff | Ess | FsFs18,19
-           | Gf Gf19,20
-           | Gf | Fss Fss19,20
-           | Gf | Fss | G G19,20
-           | Gf | Fss | G   | Aff Aff19,20
-           | Gf | Fss | G   | Aff | GsGs19,20
-           | Af Af20,21
-           | Af | Gss Gss20,21
-           | Af | Gss | A A20,21
-           | Af | Gss | A   | Bff Bff20,21
-           | Af | Gss | A   | Bff | AsAs20,21
-           | Bf Bf21,22
-           | Bf | Cff Cff21,22
-           | Bf | Cff | Ass Ass21,22
-           | Bf | Cff | Ass | B B21,22
-           | Bf | Cff | Ass | B   | CfCf21,22
-lilySyms lilySyms25,26
-lilyVals lilyVals35,36
-instance ToLily ToLily Pitch44,45
-  toLily toLily45,46
-parsePitch parsePitch47,48
-instance FromLily FromLily Pitch50,51
-  parseLily parseLily51,52
+data Pitch Pitch10,11
+data Pitch = Bs Bs10,11
+data Pitch = Bs | C C10,11
+data Pitch = Bs | C   | Bss Bss10,11
+data Pitch = Bs | C   | Bss | Dff Dff10,11
+data Pitch = Bs | C   | Bss | Dff | CsCs10,11
+           | Df Df11,12
+           | Df | Css Css11,12
+           | Df | Css | D D11,12
+           | Df | Css | D   | Eff Eff11,12
+           | Df | Css | D   | Eff | DsDs11,12
+           | Ef Ef12,13
+           | Ef | Fff Fff12,13
+           | Ef | Fff | Dss Dss12,13
+           | Ef | Fff | Dss | E E12,13
+           | Ef | Fff | Dss | E   | FfFf12,13
+           | Es Es13,14
+           | Es | F F13,14
+           | Es | F   | Gff Gff13,14
+           | Es | F   | Gff | Ess Ess13,14
+           | Es | F   | Gff | Ess | FsFs13,14
+           | Gf Gf14,15
+           | Gf | Fss Fss14,15
+           | Gf | Fss | G G14,15
+           | Gf | Fss | G   | Aff Aff14,15
+           | Gf | Fss | G   | Aff | GsGs14,15
+           | Af Af15,16
+           | Af | Gss Gss15,16
+           | Af | Gss | A A15,16
+           | Af | Gss | A   | Bff Bff15,16
+           | Af | Gss | A   | Bff | AsAs15,16
+           | Bf Bf16,17
+           | Bf | Cff Cff16,17
+           | Bf | Cff | Ass Ass16,17
+           | Bf | Cff | Ass | B B16,17
+           | Bf | Cff | Ass | B   | CfCf16,17
+lilySyms lilySyms20,21
+lilyVals lilyVals30,31
+instance ToLily ToLily Pitch39,40
+  toLily toLily40,41
+parsePitch parsePitch42,43
+instance FromLily FromLily Pitch45,46
+  parseLily parseLily46,47
 
 ./src/Chord.hs,965
-data Chord Chord18,19
-data Chord = Chord Chord18,19
-data Chord = Chord { _chordPitchOctavePairs _chordPitchOctavePairs18,19
-data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration _chordDuration18,19
-data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration :: Duration, _chordDynamic _chordDynamic18,19
-data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration :: Duration, _chordDynamic :: Dynamic, _chordAccent _chordAccent18,19
-data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration :: Duration, _chordDynamic :: Dynamic, _chordAccent :: Accent, _chordSlur _chordSlur18,19
-pairToLily pairToLily21,22
-pairsToLily pairsToLily24,25
-instance ToLily ToLily Chord27,28
-  toLily toLily28,29
-parsePair parsePair30,31
-parsePairs parsePairs33,34
-parseChord parseChord36,37
-instance FromLily FromLily Chord39,40
-  parseLily parseLily40,41
+data Chord Chord15,16
+data Chord = Chord Chord15,16
+data Chord = Chord { _chordPitchOctavePairs _chordPitchOctavePairs15,16
+data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration _chordDuration15,16
+data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration :: Duration, _chordDynamic _chordDynamic15,16
+data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration :: Duration, _chordDynamic :: Dynamic, _chordAccent _chordAccent15,16
+data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuration :: Duration, _chordDynamic :: Dynamic, _chordAccent :: Accent, _chordSlur _chordSlur15,16
+pairToLily pairToLily18,19
+pairsToLily pairsToLily21,22
+instance ToLily ToLily Chord24,25
+  toLily toLily25,26
+parsePair parsePair27,28
+parsePairs parsePairs30,31
+parseChord parseChord33,34
+instance FromLily FromLily Chord36,37
+  parseLily parseLily37,38
 
 ./src/Clef.hs,545
-data Clef Clef15,16
-data Clef = Bass8VB Bass8VB15,16
-data Clef = Bass8VB | Bass Bass15,16
-data Clef = Bass8VB | Bass | Tenor Tenor15,16
-data Clef = Bass8VB | Bass | Tenor | Alto Alto15,16
-data Clef = Bass8VB | Bass | Tenor | Alto | Treble Treble15,16
-data Clef = Bass8VB | Bass | Tenor | Alto | Treble | Treble8VATreble8VA15,16
-lilySyms lilySyms19,20
-lilyVals lilyVals23,24
-instance ToLily ToLily Clef26,27
-  toLily toLily27,28
-parseClef parseClef29,30
-instance FromLily FromLily Clef32,33
-  parseLily parseLily33,34
+data Clef Clef10,11
+data Clef = Bass8VB Bass8VB10,11
+data Clef = Bass8VB | Bass Bass10,11
+data Clef = Bass8VB | Bass | Tenor Tenor10,11
+data Clef = Bass8VB | Bass | Tenor | Alto Alto10,11
+data Clef = Bass8VB | Bass | Tenor | Alto | Treble Treble10,11
+data Clef = Bass8VB | Bass | Tenor | Alto | Treble | Treble8VATreble8VA10,11
+lilySyms lilySyms14,15
+lilyVals lilyVals18,19
+instance ToLily ToLily Clef21,22
+  toLily toLily22,23
+parseClef parseClef24,25
+instance FromLily FromLily Clef27,28
+  parseLily parseLily28,29
 
 ./src/Types.hs,24
 module Types Types1,2
 
 ./src/VoiceEvent.hs,1013
-data VoiceEvent VoiceEvent19,20
-    VoiceEventClef VoiceEventClef20,21
-    VoiceEventClef { _voiceEventClef _voiceEventClef20,21
-  | VoiceEventNote VoiceEventNote21,22
-  | VoiceEventNote { _voiceEventNote _voiceEventNote21,22
-  | VoiceEventRest VoiceEventRest22,23
-  | VoiceEventRest { _voiceEventRest _voiceEventRest22,23
-  | VoiceEventChord VoiceEventChord23,24
-  | VoiceEventChord { _voiceEventChord _voiceEventChord23,24
-  | VoiceEventTempo VoiceEventTempo24,25
-  | VoiceEventTempo { _voiceEventTempo _voiceEventTempo24,25
-  | VoiceEventKeySignature VoiceEventKeySignature25,26
-  | VoiceEventKeySignature { _voiceEventKeySignature _voiceEventKeySignature25,26
-  | VoiceEventTimeSignature VoiceEventTimeSignature26,27
-  | VoiceEventTimeSignature { _voiceEventTimeSignature _voiceEventTimeSignature26,27
-instance ToLily ToLily VoiceEvent29,30
-  toLily toLily30,31
-parseVoiceEvent parseVoiceEvent38,39
-instance FromLily FromLily VoiceEvent47,48
-  parseLily parseLily48,49
+data VoiceEvent VoiceEvent16,17
+    VoiceEventClef VoiceEventClef17,18
+    VoiceEventClef { _voiceEventClef _voiceEventClef17,18
+  | VoiceEventNote VoiceEventNote18,19
+  | VoiceEventNote { _voiceEventNote _voiceEventNote18,19
+  | VoiceEventRest VoiceEventRest19,20
+  | VoiceEventRest { _voiceEventRest _voiceEventRest19,20
+  | VoiceEventChord VoiceEventChord20,21
+  | VoiceEventChord { _voiceEventChord _voiceEventChord20,21
+  | VoiceEventTempo VoiceEventTempo21,22
+  | VoiceEventTempo { _voiceEventTempo _voiceEventTempo21,22
+  | VoiceEventKeySignature VoiceEventKeySignature22,23
+  | VoiceEventKeySignature { _voiceEventKeySignature _voiceEventKeySignature22,23
+  | VoiceEventTimeSignature VoiceEventTimeSignature23,24
+  | VoiceEventTimeSignature { _voiceEventTimeSignature _voiceEventTimeSignature23,24
+instance ToLily ToLily VoiceEvent26,27
+  toLily toLily27,28
+parseVoiceEvent parseVoiceEvent35,36
+instance FromLily FromLily VoiceEvent44,45
+  parseLily parseLily45,46
 
-./src/Duration.hs,1974
-data Duration Duration26,27
-data Duration = HTEDur HTEDur26,27
-data Duration = HTEDur | SFDur SFDur26,27
-data Duration = HTEDur | SFDur | DSFDur DSFDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur TSDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur DTSDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur SDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur DSDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur EDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur DEDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur QDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur DQDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur HDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur DHDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur | WDur WDur26,27
-data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur | WDur | DWDurDWDur26,27
-lilyVals lilyVals30,31
-lilySyms lilySyms34,35
-instance ToLily ToLily Duration37,38
-  toLily toLily38,39
-parseDuration parseDuration40,41
-instance FromLily FromLily Duration43,44
-  parseLily parseLily44,45
-integralDurations integralDurations46,47
-integralDurationSyms integralDurationSyms49,50
-newtype DurationSum DurationSum52,53
-newtype DurationSum = DurationSum { getDurSum getDurSum52,53
-durVals durVals56,57
-durVal2Duration durVal2Duration59,60
-addDur addDur62,63
-zDurSum zDurSum65,66
-sumDurs sumDurs68,69
-durSum2Durs durSum2Durs83,84
+./src/Duration.hs,1882
+data Duration Duration21,22
+data Duration = HTEDur HTEDur21,22
+data Duration = HTEDur | SFDur SFDur21,22
+data Duration = HTEDur | SFDur | DSFDur DSFDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur TSDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur DTSDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur SDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur DSDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur EDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur DEDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur QDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur DQDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur HDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur DHDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur | WDur WDur21,22
+data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur | WDur | DWDurDWDur21,22
+lilyVals lilyVals25,26
+lilySyms lilySyms29,30
+instance ToLily ToLily Duration32,33
+  toLily toLily33,34
+parseDuration parseDuration35,36
+instance FromLily FromLily Duration38,39
+  parseLily parseLily39,40
+newtype DurationSum DurationSum41,42
+newtype DurationSum = DurationSum { getDurSum getDurSum41,42
+durVals durVals45,46
+durVal2Duration durVal2Duration48,49
+addDur addDur51,52
+zDurSum zDurSum54,55
+sumDurs sumDurs57,58
+durSum2Durs durSum2Durs72,73
 
 ./src/Rest.hs,219
-newtype Rest Rest14,15
-newtype Rest = Rest { _rdur _rdur14,15
-instance ToLily ToLily Rest17,18
-  toLily toLily18,19
-parseRest parseRest20,21
-instance FromLily FromLily Rest23,24
-  parseLily parseLily24,25
+newtype Rest Rest10,11
+newtype Rest = Rest { _rdur _rdur10,11
+instance ToLily ToLily Rest13,14
+  toLily toLily14,15
+parseRest parseRest16,17
+instance FromLily FromLily Rest19,20
+  parseLily parseLily20,21
 
-./src/Lily.hs,126
-module Lily Lily2,3
-class ToLily ToLily4,5
-  toLily toLily6,7
-class FromLily FromLily8,9
-  parseLily parseLily10,11
+./src/Lily.hs,125
+module Lily Lily1,2
+class ToLily ToLily3,4
+  toLily toLily5,6
+class FromLily FromLily7,8
+  parseLily parseLily9,10
 
 ./src/KeySignature.hs,407
-data KeySignature KeySignature15,16
-data KeySignature = KeySignature KeySignature15,16
-data KeySignature = KeySignature { _kspit _kspit15,16
-data KeySignature = KeySignature { _kspit :: Pitch, _ksmode _ksmode15,16
-instance ToLily ToLily KeySignature18,19
-  toLily toLily19,20
-parseKeySignature parseKeySignature21,22
-instance FromLily FromLily KeySignature24,25
-  parseLily parseLily25,26
+data KeySignature KeySignature11,12
+data KeySignature = KeySignature KeySignature11,12
+data KeySignature = KeySignature { _kspit _kspit11,12
+data KeySignature = KeySignature { _kspit :: Pitch, _ksmode _ksmode11,12
+instance ToLily ToLily KeySignature14,15
+  toLily toLily15,16
+parseKeySignature parseKeySignature17,18
+instance FromLily FromLily KeySignature20,21
+  parseLily parseLily21,22
 
 ./src/Accent.hs,858
-data Accent Accent15,16
-data Accent = Marcato Marcato15,16
-data Accent = Marcato | Tenuto Tenuto15,16
-data Accent = Marcato | Tenuto | Staccatissimo Staccatissimo15,16
-data Accent = Marcato | Tenuto | Staccatissimo | Staccato Staccato15,16
-data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent Accent15,16
-data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato Portato15,16
-data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato | Espressivo Espressivo15,16
-data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato | Espressivo | NoAccentNoAccent15,16
-lilySyms lilySyms19,20
-lilyVals lilyVals23,24
-instance ToLily ToLily Accent26,27
-  toLily toLily27,28
-parseAccent parseAccent29,30
-instance FromLily FromLily Accent32,33
-  parseLily parseLily33,34
+data Accent Accent10,11
+data Accent = Marcato Marcato10,11
+data Accent = Marcato | Tenuto Tenuto10,11
+data Accent = Marcato | Tenuto | Staccatissimo Staccatissimo10,11
+data Accent = Marcato | Tenuto | Staccatissimo | Staccato Staccato10,11
+data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent Accent10,11
+data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato Portato10,11
+data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato | Espressivo Espressivo10,11
+data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato | Espressivo | NoAccentNoAccent10,11
+lilySyms lilySyms14,15
+lilyVals lilyVals18,19
+instance ToLily ToLily Accent21,22
+  toLily toLily22,23
+parseAccent parseAccent24,25
+instance FromLily FromLily Accent27,28
+  parseLily parseLily28,29
diff --git a/src/Accent.hs b/src/Accent.hs
index b02dbc2..8b7318b 100644
--- a/src/Accent.hs
+++ b/src/Accent.hs
@@ -1,15 +1,11 @@
 
-module Accent (Accent (..)
-              ,toLily
-              ,parseLily
-              ,parseAccent
-              ) where
+module Accent (Accent (..) ,parseAccent) where
 
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Accent = Marcato | Tenuto | Staccatissimo | Staccato | Accent | Portato | Espressivo | NoAccent
diff --git a/src/Chord.hs b/src/Chord.hs
index c45f18d..1d9d1a0 100644
--- a/src/Chord.hs
+++ b/src/Chord.hs
@@ -1,9 +1,8 @@
 
-module Chord (Chord (..)
-            ,toLily
-            ,parseLily
-            ,parseChord
-            ) where
+module Chord (Chord (..), parseChord) where
+
+import Text.Parsec
+import Text.Parsec.String
 
 import Accent
 import Duration
@@ -11,8 +10,6 @@ import Dynamic
 import Lily
 import Octave
 import Pitch
-import Text.Parsec
-import Text.Parsec.String
 import Utils
 
 -- PercussionInstrumentChord e.g. "cl" == ClavesChord
@@ -20,7 +17,7 @@ data Chord = Chord { _chordPitchOctavePairs :: [(Pitch, Octave)] , _chordDuratio
   deriving (Eq, Ord, Show)
 
 pairToLily :: (Pitch,Octave) -> String
-pairToLily (p,o) = Pitch.toLily p <> Octave.toLily o
+pairToLily (p,o) = toLily p <> toLily o
 
 pairsToLily :: [(Pitch,Octave)] -> String
 pairsToLily = unwords . map pairToLily
diff --git a/src/Clef.hs b/src/Clef.hs
index 11f224a..c608bc1 100644
--- a/src/Clef.hs
+++ b/src/Clef.hs
@@ -1,15 +1,11 @@
 
-module Clef (Clef (..)
-              ,toLily
-              ,parseLily
-              ,parseClef
-              ) where
+module Clef (Clef (..), parseClef) where
 
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Clef = Bass8VB | Bass | Tenor | Alto | Treble | Treble8VA
@@ -17,14 +13,14 @@ data Clef = Bass8VB | Bass | Tenor | Alto | Treble | Treble8VA
 
 -- parse order
 lilySyms :: [String]
-lilySyms = ["treble^8", "treble", "alto", "tenor", "bass", "bass_8"]
+lilySyms = ["\\clef treble^8", "\\clef treble", "\\clef alto", "\\clef tenor", "\\clef bass", "\\clef bass_8"]
 
 -- parse order
 lilyVals :: [Clef]
 lilyVals = [Bass8VB .. Treble8VA]
 
 instance ToLily Clef where
-  toLily = mkToLily "dynamic" lilyVals lilySyms
+  toLily = mkToLily "clef" lilyVals lilySyms
 
 parseClef :: Parser Clef
 parseClef = choice (zipWith mkParser lilySyms lilyVals)
diff --git a/src/Duration.hs b/src/Duration.hs
index 75a36d9..dfeab04 100644
--- a/src/Duration.hs
+++ b/src/Duration.hs
@@ -6,11 +6,7 @@ module Duration (Duration (..)
                 ,zDurSum
                 ,sumDurs
                 ,durSum2Durs
-                ,toLily
-                ,parseLily
                 ,parseDuration
-                ,integralDurations
-                ,integralDurationSyms
                 ) where
 
 import Data.List
@@ -18,9 +14,9 @@ import qualified Data.Map as M
 import Data.Maybe
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Duration = HTEDur | SFDur | DSFDur | TSDur | DTSDur | SDur | DSDur | EDur | DEDur | QDur | DQDur | HDur | DHDur | WDur | DWDur
@@ -43,12 +39,6 @@ parseDuration = choice $ zipWith mkParser lilySyms lilyVals
 instance FromLily Duration  where
   parseLily = mkParseLily parseDuration
 
-integralDurations :: [Duration]
-integralDurations = [WDur, HDur, QDur, EDur, SDur, SFDur, HTEDur]
-
-integralDurationSyms :: [String]
-integralDurationSyms = ["1","2","4","8","16","32","64","128"]
-
 newtype DurationSum = DurationSum { getDurSum :: Int }
   deriving (Eq, Ord, Show, Num)
 
diff --git a/src/Dynamic.hs b/src/Dynamic.hs
index 71fd034..8c7213c 100644
--- a/src/Dynamic.hs
+++ b/src/Dynamic.hs
@@ -1,15 +1,11 @@
 
-module Dynamic (Dynamic (..)
-              ,toLily
-              ,parseLily
-              ,parseDynamic
-              ) where
+module Dynamic (Dynamic (..), parseDynamic) where
 
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Dynamic = PPPPP | PPPP | PPP | PP | Piano | MP | MF | Forte | FF | FFF | FFFF | FFFFF | FP | SF | SFF | SP | SPP | SFZ | RFZ | NoDynamic
diff --git a/src/Instrument.hs b/src/Instrument.hs
index c4381b0..2272088 100644
--- a/src/Instrument.hs
+++ b/src/Instrument.hs
@@ -1,20 +1,18 @@
 
 module Instrument (Instrument (..)
-              ,toLily
-              ,parseLily
-              ,parseInstrument
-              ,midiName
-              ,shortName
-              ,shortName2LongName
-              ) where
+                  ,parseInstrument
+                  ,midiName
+                  ,shortName
+                  ,shortName2LongName
+                  ) where
 
 import Data.List
 import Data.Maybe
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Instrument =
diff --git a/src/KeySignature.hs b/src/KeySignature.hs
index fa22ad2..99b652b 100644
--- a/src/KeySignature.hs
+++ b/src/KeySignature.hs
@@ -1,17 +1,13 @@
 
-module KeySignature (KeySignature (..)
-                    ,toLily
-                    ,parseLily
-                    ,parseKeySignature
-                    ) where
+module KeySignature (KeySignature (..), parseKeySignature) where
 
-import Mode
-import Pitch
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Mode
+import Pitch
+import Utils
 
 data KeySignature = KeySignature { _kspit :: Pitch, _ksmode :: Mode }
   deriving (Eq, Ord, Show)
diff --git a/src/Lily.hs b/src/Lily.hs
index 1ba4083..b9a7626 100644
--- a/src/Lily.hs
+++ b/src/Lily.hs
@@ -1,4 +1,3 @@
--- ToLily and FromLily type classes
 
 module Lily where
 
diff --git a/src/Mode.hs b/src/Mode.hs
index 1f2fc68..432dc3b 100644
--- a/src/Mode.hs
+++ b/src/Mode.hs
@@ -1,17 +1,12 @@
 
-module Mode (Mode (..)
-              ,toLily
-              ,parseLily
-              ,parseMode
-              ) where
+module Mode (Mode (..), parseMode) where
 
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
--- Ord order
 data Mode = Major | Minor
   deriving (Eq, Ord, Show, Enum, Bounded)
 
diff --git a/src/Note.hs b/src/Note.hs
index 11c7d5b..268944d 100644
--- a/src/Note.hs
+++ b/src/Note.hs
@@ -1,9 +1,7 @@
 
-module Note (Note (..)
-            ,toLily
-            ,parseLily
-            ,parseNote
-            ) where
+module Note (Note (..), parseNote) where
+
+import Text.Parsec.String
 
 import Accent
 import Duration
@@ -11,7 +9,6 @@ import Dynamic
 import Lily
 import Octave
 import Pitch
-import Text.Parsec.String
 import Utils
 
 -- PercussionInstrumentNote e.g. "cl" == ClavesNote
diff --git a/src/Octave.hs b/src/Octave.hs
index 11ac1e5..df16f2e 100644
--- a/src/Octave.hs
+++ b/src/Octave.hs
@@ -1,7 +1,5 @@
 
 module Octave (Octave (..)
-              ,toLily
-              ,parseLily
               ,parseOct
               ,incrOct
               ,decrOct
@@ -9,9 +7,9 @@ module Octave (Octave (..)
 
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Octave = TwentyTwoVBOct | FifteenVBOct | EightVBOct | COct | EightVAOct | FifteenVAOct | TwentyTwoVAOct | TwentyNineVAOct
diff --git a/src/Pitch.hs b/src/Pitch.hs
index 8afb195..7c75655 100644
--- a/src/Pitch.hs
+++ b/src/Pitch.hs
@@ -1,15 +1,11 @@
 
-module Pitch (Pitch (..)
-              ,toLily
-              ,parseLily
-              ,parsePitch
-              ) where
+module Pitch (Pitch (..), parsePitch) where
 
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
 import Lily
+import Utils
 
 -- Ord order
 data Pitch = Bs | C   | Bss | Dff | Cs
diff --git a/src/Rest.hs b/src/Rest.hs
index 17d79a0..e15542a 100644
--- a/src/Rest.hs
+++ b/src/Rest.hs
@@ -1,15 +1,11 @@
 
-module Rest (Rest (..)
-            ,toLily
-            ,parseLily
-            ,parseRest
-            ) where
+module Rest (Rest (..),parseRest) where
 
-import Accent
-import Duration
-import Lily
 import Text.Parsec
 import Text.Parsec.String
+
+import Duration
+import Lily
 import Utils
 
 newtype Rest = Rest { _rdur :: Duration }
diff --git a/src/Score.hs b/src/Score.hs
index beed5cc..a624006 100644
--- a/src/Score.hs
+++ b/src/Score.hs
@@ -3,9 +3,10 @@
 module Score (Score (..)) where
 
 import Data.String.Interpolation
-import Lily
 import Text.Parsec
 import Text.Parsec.String
+
+import Lily
 import Utils
 import Voice
 
diff --git a/src/Tempo.hs b/src/Tempo.hs
index 1feecd8..e474baa 100644
--- a/src/Tempo.hs
+++ b/src/Tempo.hs
@@ -1,17 +1,14 @@
 {-# LANGUAGE QuasiQuotes #-}
 
-module Tempo (Tempo (..)
-             ,toLily
-             ,parseLily
-             ,parseTempo
-             ) where
+module Tempo (Tempo (..), parseTempo) where
 
 import Data.Natural
 import Data.String.Interpolation
-import Duration
-import Lily
 import Text.Parsec
 import Text.Parsec.String
+
+import Duration
+import Lily
 import Utils
 
 data Tempo = TempoText   { _ttText :: String }
diff --git a/src/TimeSignature.hs b/src/TimeSignature.hs
index 4457a92..cf8cbd8 100644
--- a/src/TimeSignature.hs
+++ b/src/TimeSignature.hs
@@ -1,26 +1,28 @@
---  TODO: groupings and beats per measure \time #'(2 2 3) 7/8
 
-module TimeSignature (TimeSignature (..)
-                     ,toLily
-                     ,parseLily
-                     ,parseTimeSignature
-                     ) where
+module TimeSignature (TimeSignature (..),parseTimeSignature) where
 
-import Duration
+import Data.List
 import Text.Parsec
 import Text.Parsec.String
-import Utils
 
+import Duration
 import Lily
+import Utils
 
-data TimeSignature = TimeSignature { _tsnum :: Int, _tsdenom :: Duration }
+data TimeSignature = TimeSignature { _tsNum :: Int, _tsDenom :: Duration }
+                   | TimeSignatureGrouping { _tsgGroups :: [Int], tsgNum :: Int, tsgDenom :: Duration }
   deriving (Eq, Ord, Show)
 
 instance ToLily TimeSignature where
   toLily (TimeSignature num denom) = "\\time " <> show num <> "/" <> toLily denom
+  toLily (TimeSignatureGrouping nums num denom) = "\\time #'(" <>  intercalate "," (map show nums) <> ")"  <> " " <> show num <> "/" <> toLily denom
 
 parseTimeSignature :: Parser TimeSignature
-parseTimeSignature = TimeSignature <$> (string "\\time " *> parseInt) <*> (string "/" *> parseDuration)
+parseTimeSignature = choice [try (TimeSignatureGrouping <$> (string "\\time #'" *> parseIntList) <*> parseInt  <*> (string "/" *> parseDuration))
+                            ,try (TimeSignature <$> (string "\\time " *> parseInt) <*> (string "/" *> parseDuration))]
+
+parseIntList :: Parser [Int]
+parseIntList = between (symbol '(') (symbol ')') (parseInt `sepBy` char ',')
 
 instance FromLily TimeSignature where
   parseLily = mkParseLily parseTimeSignature
diff --git a/src/Types.hs b/src/Types.hs
index 4d19855..874ebb9 100644
--- a/src/Types.hs
+++ b/src/Types.hs
@@ -23,8 +23,6 @@ module Types (Accent (..)
              ,TimeSignature (..)
              ,Voice (..)
              ,VoiceEvent (..)
-             ,toLily
-             ,parseLily
              ) where
 
 import Accent
diff --git a/src/Utils.hs b/src/Utils.hs
index ba4e805..0f498cd 100644
--- a/src/Utils.hs
+++ b/src/Utils.hs
@@ -1,4 +1,6 @@
-module Utils (parseInt
+
+module Utils (symbol
+             ,parseInt
              ,parseNatural
              ,parseBool
              ,mkParser
diff --git a/src/Voice.hs b/src/Voice.hs
index a65b53b..e40dd29 100644
--- a/src/Voice.hs
+++ b/src/Voice.hs
@@ -1,14 +1,13 @@
 {-# LANGUAGE QuasiQuotes #-}
 
-module Voice (Voice (..)
-             ,parseVoice
-             ) where
+module Voice (Voice (..), parseVoice) where
 
 import Data.String.Interpolation
-import Instrument
-import Lily
 import Text.Parsec
 import Text.Parsec.String
+
+import Instrument
+import Lily
 import Utils
 import VoiceEvent
 
diff --git a/src/VoiceEvent.hs b/src/VoiceEvent.hs
index 6d459d1..f163ea2 100644
--- a/src/VoiceEvent.hs
+++ b/src/VoiceEvent.hs
@@ -1,9 +1,8 @@
 
-module VoiceEvent (VoiceEvent (..)
-                  ,toLily
-                  ,parseLily
-                  ,parseVoiceEvent
-                  ) where
+module VoiceEvent (VoiceEvent (..), parseVoiceEvent) where
+
+import Text.Parsec
+import Text.Parsec.String
 
 import Chord
 import Clef
@@ -12,8 +11,6 @@ import Lily
 import Note
 import Rest
 import Tempo
-import Text.Parsec
-import Text.Parsec.String
 import TimeSignature
 import Utils
 
diff --git a/test/Main.hs b/test/Main.hs
index 0b70735..b3bf6ae 100644
--- a/test/Main.hs
+++ b/test/Main.hs
@@ -121,7 +121,7 @@ instance Arbitrary Tempo where
                     ]
 
 instance Arbitrary TimeSignature where
-  arbitrary = TimeSignature <$> elements [1..10] <*> elements integralDurations
+  arbitrary = TimeSignature <$> elements [1..10] <*> elements [WDur, HDur, QDur, EDur, SDur, SFDur, HTEDur]
   shrink = genericShrink
 
 propParseLilytoLilyVal :: (Eq a, ToLily a, FromLily a) => a -> Bool
